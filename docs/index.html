<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PineUI Demo - Server-Driven UI</title>
  <link rel="stylesheet" href="./pineui.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }

    .header {
      color: white;
      padding: 2rem;
      text-align: center;
    }

    .header h1 {
      font-size: 3rem;
      margin-bottom: 0.5rem;
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.95;
      margin-bottom: 0.5rem;
    }

    .header .subtitle {
      font-size: 0.95rem;
      opacity: 0.85;
    }

    .header .links {
      margin-top: 1rem;
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .header .links a {
      color: white;
      text-decoration: none;
      padding: 0.5rem 1rem;
      background: rgba(255,255,255,0.2);
      border-radius: 8px;
      font-size: 0.9rem;
      transition: background 0.2s;
    }

    .header .links a:hover {
      background: rgba(255,255,255,0.3);
    }

    .header .links a.active {
      background: rgba(255,255,255,0.4);
      font-weight: 600;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 0 1rem 2rem;
    }

    /* Demos que precisam de mais espa√ßo */
    .container--wide {
      max-width: 1400px;
    }

    /* Inbox precisa de muito mais espa√ßo (3 colunas largas) */
    .container--inbox {
      max-width: 1800px;
    }

    .demo-controls {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 1rem;
      gap: 8px;
    }

    .demo-controls button {
      padding: 10px 20px;
      border: none;
      background: rgba(255,255,255,0.2);
      color: white;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .demo-controls button:hover {
      background: rgba(255,255,255,0.3);
    }

    .demo-controls button.active {
      background: white;
      color: #667eea;
    }

    .demo-container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    #pineui-root {
      width: 100%;
      display: block;
    }

    #ui-view, #api-view {
      width: 100%;
      display: none;
      background: #0d1117;
      color: #c9d1d9;
      overflow: auto;
      min-height: 600px;
    }

    #ui-view pre, #api-view pre {
      margin: 0;
      padding: 24px;
    }

    #ui-view code, #api-view code {
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      font-size: 14px;
      line-height: 1.5;
    }

    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 400px;
      padding: 60px 20px;
      color: #666;
      gap: 16px;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .footer {
      text-align: center;
      color: white;
      padding: 2rem;
      opacity: 0.9;
    }

    .footer a {
      color: white;
      text-decoration: underline;
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .header {
        padding: 1.5rem 1rem;
      }

      .header h1 {
        font-size: 2rem;
      }

      .header p {
        font-size: 1rem;
      }

      .header .subtitle {
        font-size: 0.85rem;
      }

      .header .links {
        gap: 0.5rem;
      }

      .header .links a {
        font-size: 0.8rem;
        padding: 0.4rem 0.8rem;
      }

      .container {
        padding: 0 0.75rem 1.5rem;
      }

      .container--wide,
      .container--inbox {
        max-width: 100%;
        padding: 0 0.75rem 1.5rem;
      }

      .demo-controls {
        flex-wrap: wrap;
        justify-content: center;
        gap: 6px;
      }

      .demo-controls button {
        padding: 8px 16px;
        font-size: 13px;
      }

      .demo-container {
        border-radius: 12px;
      }

      #ui-view, #api-view {
        min-height: 400px;
      }

      #ui-view pre, #api-view pre {
        padding: 16px;
      }

      #ui-view code, #api-view code {
        font-size: 12px;
      }

      .loading {
        min-height: 300px;
        padding: 40px 16px;
      }

      .footer {
        padding: 1.5rem 1rem;
        font-size: 0.9rem;
      }
    }

    @media (max-width: 480px) {
      .header h1 {
        font-size: 1.75rem;
      }

      .header p {
        font-size: 0.95rem;
      }

      .header .links a {
        font-size: 0.75rem;
        padding: 0.35rem 0.7rem;
      }

      .demo-controls button {
        padding: 7px 14px;
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <div style="background: rgba(0,0,0,0.35); color: rgba(255,255,255,0.9); text-align: center; padding: 0.5rem 1rem; font-size: 0.85rem; letter-spacing: 0.02em;">
    ‚ö†Ô∏è <strong>Alpha</strong> ‚Äî APIs and schema contracts will change. Not production-ready.
  </div>
  <div class="header">
    <h1>üçç PineUI <span style="font-size: 1rem; font-weight: 400; opacity: 0.7; vertical-align: middle; background: rgba(255,255,255,0.15); padding: 2px 10px; border-radius: 12px; margin-left: 8px;">alpha</span></h1>
    <p>Server-Driven UI for AI-Native Applications</p>
    <div class="links">
      <a href="?demo=twitter" data-demo="twitter">üê¶ Twitter</a>
      <a href="?demo=simple" data-demo="simple">üé® Simple</a>
      <a href="?demo=gallery" data-demo="gallery">üñºÔ∏è Gallery</a>
      <a href="?demo=inbox" data-demo="inbox">üì¨ Inbox</a>
      <a href="?demo=admin" data-demo="admin">üë• Admin</a>
    </div>
    <div style="margin-top: 0.5rem; display: flex; gap: 1.5rem; justify-content: center; flex-wrap: wrap;">
      <a href="./documentation.html" target="_blank" style="color: white; text-decoration: underline; font-size: 0.9rem; opacity: 0.85;">üìñ Documentation</a>
      <a href="https://github.com/pineui/pineui" target="_blank" style="color: white; text-decoration: underline; font-size: 0.9rem; opacity: 0.85;">View on GitHub ‚Üí</a>
    </div>
  </div>

  <div class="container">
    <div class="demo-controls">
      <button id="view-btn" class="active" onclick="switchToView()">üëÅÔ∏è Renderizado</button>
      <button id="ui-btn" onclick="switchToUI()">üíª UI (JSON)</button>
      <button id="api-btn" onclick="switchToAPI()">üîå API (JSON)</button>
    </div>

    <div class="demo-container">
      <div id="pineui-root">
        <div class="loading">
          <div class="spinner"></div>
          <p>Carregando PineUI...</p>
        </div>
      </div>

      <div id="ui-view">
        <pre><code id="ui-code" class="language-json"></code></pre>
      </div>

      <div id="api-view">
        <pre><code id="api-code" class="language-json"></code></pre>
      </div>
    </div>
  </div>

  <div class="footer">
    <p>‚ú® Tudo declarativo, multi-plataforma e AI-friendly</p>
    <p style="margin-top: 0.5rem; font-size: 0.9rem;">
      <a href="https://github.com/pineui/pineui">Veja o c√≥digo no GitHub</a>
    </p>
  </div>

  <script src="./pineui.standalone.js"></script>
  <script src="./mock-api.js"></script>
  <script>
    let currentSchema = null;
    let currentAPIData = null;
    let currentMode = 'view';

    function switchToView() {
      currentMode = 'view';
      document.getElementById('pineui-root').style.display = 'block';
      document.getElementById('ui-view').style.display = 'none';
      document.getElementById('api-view').style.display = 'none';
      document.getElementById('view-btn').classList.add('active');
      document.getElementById('ui-btn').classList.remove('active');
      document.getElementById('api-btn').classList.remove('active');
    }

    function switchToUI() {
      currentMode = 'ui';
      document.getElementById('pineui-root').style.display = 'none';
      document.getElementById('ui-view').style.display = 'block';
      document.getElementById('api-view').style.display = 'none';
      document.getElementById('view-btn').classList.remove('active');
      document.getElementById('ui-btn').classList.add('active');
      document.getElementById('api-btn').classList.remove('active');

      if (currentSchema) {
        const codeElement = document.getElementById('ui-code');
        codeElement.textContent = JSON.stringify(currentSchema, null, 2);
        hljs.highlightElement(codeElement);
      }
    }

    function switchToAPI() {
      currentMode = 'api';
      document.getElementById('pineui-root').style.display = 'none';
      document.getElementById('ui-view').style.display = 'none';
      document.getElementById('api-view').style.display = 'block';
      document.getElementById('view-btn').classList.remove('active');
      document.getElementById('ui-btn').classList.remove('active');
      document.getElementById('api-btn').classList.add('active');

      if (currentAPIData) {
        const codeElement = document.getElementById('api-code');
        codeElement.textContent = JSON.stringify(currentAPIData, null, 2);
        hljs.highlightElement(codeElement);
      }
    }

    // Update active link
    const urlParams = new URLSearchParams(window.location.search);
    const demo = urlParams.get('demo') || 'twitter';
    document.querySelectorAll('.header .links a[data-demo]').forEach(link => {
      if (link.dataset.demo === demo) {
        link.classList.add('active');
      }
    });

    // Adjust container width for demos that need more space
    const container = document.querySelector('.container');
    if (demo === 'inbox') {
      container.classList.add('container--inbox');
    } else if (demo === 'admin' || demo === 'gallery') {
      container.classList.add('container--wide');
    }

    console.log('üçç Initializing PineUI...');

    window.addEventListener('load', async function() {
      console.log('‚úÖ Page loaded');

      if (!window.PineUI || !window.PineUI.render) {
        console.error('‚ùå PineUI SDK not loaded');
        document.getElementById('pineui-root').innerHTML = `
          <div class="loading">
            <p style="color: red;">SDK n√£o carregado. Verifique o console.</p>
          </div>
        `;
        return;
      }

      console.log('‚úÖ PineUI SDK found');

      // Load API definitions for this demo
      if (window.loadAPIDefinitions) {
        await window.loadAPIDefinitions(demo);
      }

      // Initialize mock API
      if (window.initMockAPI) {
        window.initMockAPI(demo);
      }

      // Load UI schema
      const schemaFile = `./demos/${demo}/ui.json`;
      console.log('Loading schema:', schemaFile);

      try {
        const response = await fetch(schemaFile);
        if (!response.ok) {
          throw new Error(`Failed to load schema: ${response.status}`);
        }

        const schema = await response.json();
        console.log('‚úÖ Schema loaded');
        currentSchema = schema;

        // Load API data for code view
        const apiFile = `./demos/${demo}/api.json`;
        try {
          const apiResponse = await fetch(apiFile);
          if (apiResponse.ok) {
            currentAPIData = await apiResponse.json();
            console.log('‚úÖ API data loaded');
          }
        } catch (e) {
          console.warn('‚ö†Ô∏è No API data file');
        }

        window.PineUI.render({
          target: '#pineui-root',
          schema: schema,
          baseUrl: `./demos/${demo}/`,
          onReady: () => {
            console.log('‚úÖ PineUI is ready!');
          },
          onError: (error) => {
            console.error('‚ùå PineUI error:', error);
            document.getElementById('pineui-root').innerHTML = `
              <div class="loading">
                <p style="color: red;">Erro ao carregar: ${error.message}</p>
                <button onclick="location.reload()" style="
                  padding: 10px 20px;
                  border: none;
                  background: #667eea;
                  color: white;
                  border-radius: 8px;
                  cursor: pointer;
                  font-size: 14px;
                ">Tentar novamente</button>
              </div>
            `;
          }
        });
      } catch (error) {
        console.error('‚ùå Failed to load schema:', error);
        document.getElementById('pineui-root').innerHTML = `
          <div class="loading">
            <p style="color: red;">Erro ao carregar schema: ${error.message}</p>
          </div>
        `;
      }
    });
  </script>
</body>
</html>
